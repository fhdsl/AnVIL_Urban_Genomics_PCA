[["index.html", "AnVIL Urban Genomics: Pigeon Population Structure About this Book Skills Level", " AnVIL Urban Genomics: Pigeon Population Structure February 22, 2023 About this Book This book is part of a series of books for the Genomic Data Science Analysis, Visualization, and Informatics Lab-space (AnVIL) of the National Human Genome Research Institute (NHGRI). Learn more about AnVIL by visiting https://anvilproject.org or reading the article in Cell Genomics. Skills Level Genetics Beginner: minimal genetics knowledge needed Programming skills Beginner: minimal programming experience needed "],["learning-objectives.html", "Learning Objectives AnVIL Collection", " Learning Objectives AnVIL Collection Please check out our full collection of AnVIL and related resources below! Book Name Description Topics AnVIL Phylogenetic-Techniques (github) A semester-long course on the basics of molecular phylogenetic techniques anvil, r-programming AnVIL SRA Data (github) Pull Sequence Read Archive (SRA) data into AnVIL anvil AnVIL: Getting Started (github) A guide for getting started using AnVIL anvil, cloud-computing AnVIL: Instructor Guide (github) A guide for instructors using AnVIL for workshops, lessons, or courses. anvil, education GDSCN: SARS Galaxy on AnVIL (github) Lab module and lectures for variant detection in SARS-CoV-2 using Galaxy anvil, genomics, module GDSCN: Statistics for Genomics Differential Expression (github) A set of lab modules for an introduction to differential gene expression anvil, cloud-computing, gene-expression GDSCN: Statistics for Genomics PCA (github) A set of lab modules for PCA analysis anvil GDSCN: Statistics for Genomics RNA-seq (github) A set of lab modules for RNA-seq analysis anvil GDSCN: Statistics for Genomics scRNA-seq (github) A set of lab modules for single cell RNA-seq analysis anvil "],["instructor-guide.html", "Instructor Guide Suggested Activity Context Lesson Plan Notes for Instructors Getting Credit for Professional Development", " Instructor Guide Suggested Activity Context Course Audience Undergraduate biology majors Graduate students with less exposure to bioinformatics Course Prerequisites Layman understanding of genetics (understanding of DNA, genes, trait inheritance) Some previous exposure to graphing Class Type Lab Computer-based Class Size 1-50 Lesson Duration Coming soon! Assessment Type Short answer questions at each lab stage Lesson Plan Coming soon! Notes for Instructors This R-based activity can be run on a different platform, such as your own personal installation of R or Posit(formerly called RStudio), depending on your needs. More Coming soon! Getting Credit for Professional Development We are happy to provide a letter to your supervisor, department head, or dean to indicate you’ve worked through this content and intend to use it in your class. "],["population-genetics-in-the-urban-environment.html", "Chapter 1 Population Genetics in the Urban Environment", " Chapter 1 Population Genetics in the Urban Environment This lecture module discusses what population genetics can tell us about the urban facilitation and urban fragmentation models of urbanization. Learning Objectives Learn what urbanization is and how it affects the abiotic and biotic environments. Understand the difference between the urban facilitation and urban fragmentation hypothesis. Learn what population structure, gene flow, and genetic drift are. Understand how gene flow and genetic drift behave under the urban facilitation and urban fragmentation hypotheses. You can view and download the Google Slides here "],["principal-component-analysis.html", "Chapter 2 Principal Component Analysis", " Chapter 2 Principal Component Analysis This lecture module introduces the basic theory of principal component analysis. Learning Objectives Learn what principal component analysis is and why it is useful in bioinformatics. Understand how PCs are calculated You can view and download the Google Slides here If you would like to learn more about the math behind PCA, check out StatQuest’s awesome YouTube videos on this topic. StatQuest: PCA main ideas in only 5 minutes!!! StatQuest: Principal Component Analysis, Step-by-Step "],["rock-pigeons.html", "Chapter 3 Rock Pigeons", " Chapter 3 Rock Pigeons This lecture module gives a brief introduction to the rock pigeon. Learning Objectives Learn about the basic natural history of rock pigeons. Understand the difference between wild, domesticated, and feral pigeons. Understand why pigeons have been successful in the urban environment. You can view and download the Google Slides here "],["activity-overview.html", "Chapter 4 Activity Overview", " Chapter 4 Activity Overview This activity is based on work published by Drs. Elizabeth Carlen and Jason Munshi-South in 2021, “Widespread genetic connectivity of feral pigeons across the Northeastern megacity”. In this module, you will work with SNP data from a subsample of 50 feral pigeons (collected in 6 different Northeastern US cities) that were captured and sampled in Carlen and Munshi-South’s study. You will calculate PCA and create plots to visualize the population structure among these pigeons using the R programming language. You can read the full study here. This is a brief video introduction to the activity. You can view and download the Google Slides here "],["before-you-begin.html", "Chapter 5 Before you begin 5.1 Accessing AnVIL 5.2 Cloning the workspace 5.3 Using RStudio", " Chapter 5 Before you begin Before diving into the activity, you’ll need to do a couple of things first, including creating a Google account to use AnVIL and cloning the activity workspace. 5.1 Accessing AnVIL You will need to create a Google account in order to use AnVIL. If you do not already have a Google account that you would like to use for accessing Terra, create one now. If you would like to create a Google account that is associated with your non-Gmail, institutional email address, follow these instructions. 5.2 Cloning the workspace You will also need to clone the AnVIL workspace for this activity. 5.3 Using RStudio This activity uses the RStudio environment on AnVIL. 5.3.1 Video overview on using RStudio Here is a video tutorial that describes the basics of using RStudio on AnVIL. 5.3.2 Objectives Start compute for your RStudio environment Tour RStudio on AnVIL Stop compute to minimize expenses 5.3.3 Slides The slides for this tutorial are are located here. 5.3.4 Launching RStudio AnVIL is very versatile and can scale up to use very powerful cloud computers. It’s very important that you select a cloud computing environment appropriate to your needs to avoid runaway costs. If you are uncertain, start with the default settings; it is fairly easy to increase your compute resources later, if needed, but harder to scale down. Note that, in order to use RStudio, you must have access to a Terra Workspace with permission to compute (i.e. you must be a “Writer” or “Owner” of the Workspace). Open Terra - use a web browser to go to anvil.terra.bio In the drop-down menu on the left, navigate to “Workspaces”. Click the triple bar in the top left corner to access the menu. Click “Workspaces”. Click on the name of your Workspace. You should be routed to a link that looks like: https://anvil.terra.bio/#workspaces/&lt;billing-project&gt;/&lt;workspace-name&gt;. Click on the cloud icon on the far right to access your Cloud Environment options. In the dialogue box, click the “Settings” button under RStudio You will see some details about the default RStudio cloud environment, and a list of costs because it costs a small amount of money to use cloud computing. If you are uncertain about what you need, the default configuration is a reasonable, cost-conservative choice. It is fairly easy to increase your compute resources later, if needed, but harder to scale down. Click the “Create” button. Otherwise, click “CUSTOMIZE” to modify the environment for your needs. The dialogue box will close and you will be returned to your Workspace. You can see the status of your cloud environment by hovering over the RStudio logo. It will take a few minutes for Terra to request computers and install software. When your environment is ready, its status will change to “Running”. Click on the RStudio logo to open a new dialogue box that will let you launch RStudio. Click the launch icon to open RStudio. This is also where you can pause, modify, or delete your environment when needed. You should now see the RStudio interface with information about the version printed to the console. 5.3.5 Touring RStudio Next, we will be using RStudio and the package Glimma to create interactive plots. See this vignette for more information. The Bioconductor team has created a very useful package to programmatically interact with Terra and Google Cloud. Install the AnVIL package. It will make some steps easier as we go along. You can now quickly install precompiled binaries using the AnVIL package’s install() function. We will use it to install the Glimma package and the airway package. The airway package contains a SummarizedExperiment data class. This data describes an RNA-Seq experiment on four human airway smooth muscle cell lines treated with dexamethasone. {Note: for some of the packages, you will have to install packaged from the CRAN repository, using the install.packages() function. The examples will show you which install method to use.} &lt;img src=&quot;07-activity_introduction_files/figure-html//1BLTCaogA04bbeSD1tR1Wt-mVceQA6FHXa8FmFzIARrg_g11f12bc99af_0_56.png&quot; title=&quot;Screenshot of the RStudio environment interface. Code has been typed in the console and is highlighted.&quot; alt=&quot;Screenshot of the RStudio environment interface. Code has been typed in the console and is highlighted.&quot; width=&quot;480&quot; /&gt; Load the example data. The multidimensional scaling (MDS) plot is frequently used to explore differences in samples. When this data is MDS transformed, the first two dimensions explain the greatest variance between samples, and the amount of variance decreases monotonically with increasing dimension. The following code will launch a new window where you can interact with the MDS plot. Change the colour_by setting to “groups” so you can easily distinguish between groups. In this data, the “group” is the treatment. You can download the interactive html file by clicking on “Save As”. You can also download plots and other files created directly in RStudio. To download the following plot, click on “Export” and save in your preferred format to the default directory. This saves the file in your cloud environment. You should see the plot in the “Files” pane. Select this file and click “More” &gt; “Export” Select “Download” to save the file to your local machine. 5.3.6 Pausing RStudio The upper right corner reminds you that you are accruing cloud computing costs. You should minimize charges when you are not performing an analysis. You can do this by clicking on “Stop cloud environment”. This will release the CPU and memory resources for other people to use. Note that your work will be saved in the environment and continue to accrue a very small cost. This work will be lost if the cloud environment gets deleted. If there is anything you would like to save permanently, it’s a good idea to copy it from your compute environment to another location, such as the Workspace bucket, GitHub, or your local machine, depending on your needs. 5.3.7 Deleting RStudio Stopping your cloud environment only pauses your work. When you are ready to delete the cloud environment, click on the gear icon in the upper right corner to “Update cloud environment”. Click on “Delete Environment Options”. If you are certain that you do not need the data and configuration on your disk, you should select “Delete everything, including persistent disk”. If there is anything you would like to save, open the compute environment and copy the file(s) from your compute environment to another location, such as the Workspace bucket, GitHub, or your local machine, depending on your needs. Select “DELETE”. "],["about-the-authors.html", "About the Authors", " About the Authors These credits are based on our course contributors table guidelines.     Credits Names Pedagogy Lead Content Instructor Elizabeth Humphries Content Reviewers Ava Hoffman, Frederick Tan Technical Course Publishing Engineer Ava Hoffman Template Publishing Engineers Candace Savonen, Carrie Wright Publishing Maintenance Engineer Candace Savonen Technical Publishing Stylists Carrie Wright, Candace Savonen Package Developers (ottrpal) John Muschelli, Candace Savonen, Carrie Wright Funding Funder National Human Genome Research Institute (NHGRI) #5U24HG010263 Funding Staff Fallon Bachman, Jennifer Vessio, Emily Voeglein   ## ─ Session info ─────────────────────────────────────────────────────────────── ## setting value ## version R version 4.0.2 (2020-06-22) ## os Ubuntu 20.04.3 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Etc/UTC ## date 2023-02-22 ## ## ─ Packages ─────────────────────────────────────────────────────────────────── ## package * version date lib source ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.0.3) ## bookdown 0.24 2022-02-15 [1] Github (rstudio/bookdown@88bc4ea) ## callr 3.4.4 2020-09-07 [1] RSPM (R 4.0.2) ## cli 2.0.2 2020-02-28 [1] RSPM (R 4.0.0) ## crayon 1.3.4 2017-09-16 [1] RSPM (R 4.0.0) ## desc 1.2.0 2018-05-01 [1] RSPM (R 4.0.3) ## devtools 2.3.2 2020-09-18 [1] RSPM (R 4.0.3) ## digest 0.6.25 2020-02-23 [1] RSPM (R 4.0.0) ## ellipsis 0.3.1 2020-05-15 [1] RSPM (R 4.0.3) ## evaluate 0.14 2019-05-28 [1] RSPM (R 4.0.3) ## fansi 0.4.1 2020-01-08 [1] RSPM (R 4.0.0) ## fs 1.5.0 2020-07-31 [1] RSPM (R 4.0.3) ## glue 1.6.1 2022-01-22 [1] CRAN (R 4.0.2) ## htmltools 0.5.0 2020-06-16 [1] RSPM (R 4.0.1) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.0.2) ## knitr 1.33 2022-02-15 [1] Github (yihui/knitr@a1052d1) ## lifecycle 1.0.0 2021-02-15 [1] CRAN (R 4.0.2) ## magrittr 2.0.2 2022-01-26 [1] CRAN (R 4.0.2) ## memoise 1.1.0 2017-04-21 [1] RSPM (R 4.0.0) ## pkgbuild 1.1.0 2020-07-13 [1] RSPM (R 4.0.2) ## pkgload 1.1.0 2020-05-29 [1] RSPM (R 4.0.3) ## prettyunits 1.1.1 2020-01-24 [1] RSPM (R 4.0.3) ## processx 3.4.4 2020-09-03 [1] RSPM (R 4.0.2) ## ps 1.3.4 2020-08-11 [1] RSPM (R 4.0.2) ## purrr 0.3.4 2020-04-17 [1] RSPM (R 4.0.3) ## R6 2.4.1 2019-11-12 [1] RSPM (R 4.0.0) ## remotes 2.2.0 2020-07-21 [1] RSPM (R 4.0.3) ## rlang 0.4.10 2022-02-15 [1] Github (r-lib/rlang@f0c9be5) ## rmarkdown 2.10 2022-02-15 [1] Github (rstudio/rmarkdown@02d3c25) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.0.2) ## sessioninfo 1.1.1 2018-11-05 [1] RSPM (R 4.0.3) ## stringi 1.5.3 2020-09-09 [1] RSPM (R 4.0.3) ## stringr 1.4.0 2019-02-10 [1] RSPM (R 4.0.3) ## testthat 3.0.1 2022-02-15 [1] Github (R-lib/testthat@e99155a) ## usethis 2.1.5.9000 2022-02-15 [1] Github (r-lib/usethis@57b109a) ## withr 2.3.0 2020-09-22 [1] RSPM (R 4.0.2) ## xfun 0.26 2022-02-15 [1] Github (yihui/xfun@74c2a66) ## yaml 2.2.1 2020-02-01 [1] RSPM (R 4.0.3) ## ## [1] /usr/local/lib/R/site-library ## [2] /usr/local/lib/R/library "],["references.html", "Chapter 6 References", " Chapter 6 References Carlen, E, Munshi-South, J. Widespread genetic connectivity of feral pigeons across the Northeastern megacity. Evol Appl. 2021; 14: 150– 162. https://doi.org/10.1111/eva.12972 Johnson MTJ, Munshi-South J. Evolution of life in urban environments. Science. 2017 Nov 3;358(6363):eaam8327. doi: 10.1126/science.aam8327. PMID: 29097520. Lowther, P. E. and R. F. Johnston (2020). Rock Pigeon (Columba livia), version 1.0. In Birds of the World (S. M. Billerman, Editor). Cornell Lab of Ornithology, Ithaca, NY, USA. https://doi.org/10.2173/bow.rocpig.01 Miles LS, Rivkin LR, Johnson MTJ, Munshi-South J, Verrelli BC. Gene flow and genetic drift in urban environments. Mol Ecol. 2019 Sep;28(18):4138-4151. doi: 10.1111/mec.15221. Epub 2019 Sep 24. PMID: 31482608. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
